"use strict";var $=Object.defineProperty;var ur=Object.getOwnPropertyDescriptor;var cr=Object.getOwnPropertyNames;var lr=Object.prototype.hasOwnProperty;var mr=(t,e)=>{for(var r in e)$(t,r,{get:e[r],enumerable:!0})},fr=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of cr(e))!lr.call(t,n)&&n!==r&&$(t,n,{get:()=>e[n],enumerable:!(s=ur(e,n))||s.enumerable});return t};var dr=t=>fr($({},"__esModule",{value:!0}),t);var As={};mr(As,{ContentType:()=>M,LabelName:()=>c,LinkType:()=>P,Severity:()=>Ct,Stage:()=>Tt,Status:()=>u,StatusByPriority:()=>xt,allureId:()=>zt,attachTrace:()=>Ot,attachment:()=>Ft,attachmentPath:()=>jt,description:()=>kt,descriptionHtml:()=>_t,displayName:()=>Mt,epic:()=>Bt,feature:()=>Wt,historyId:()=>Lt,issue:()=>Ut,label:()=>y,labels:()=>Dt,layer:()=>Zt,link:()=>I,links:()=>Rt,logStep:()=>Ht,owner:()=>Yt,parameter:()=>wt,parentSuite:()=>Vt,severity:()=>Jt,step:()=>Nt,story:()=>Kt,subSuite:()=>qt,suite:()=>$t,tag:()=>Xt,tags:()=>Qt,testCaseId:()=>It,tms:()=>Gt});module.exports=dr(As);var u=(function(t){return t.FAILED="failed",t.BROKEN="broken",t.PASSED="passed",t.SKIPPED="skipped",t})({}),xt=[u.FAILED,u.BROKEN,u.PASSED,u.SKIPPED],Tt=(function(t){return t.SCHEDULED="scheduled",t.RUNNING="running",t.FINISHED="finished",t.PENDING="pending",t.INTERRUPTED="interrupted",t})({}),c=(function(t){return t.ALLURE_ID="ALLURE_ID",t.AS_ID="ALLURE_ID",t.SUITE="suite",t.PARENT_SUITE="parentSuite",t.SUB_SUITE="subSuite",t.EPIC="epic",t.FEATURE="feature",t.STORY="story",t.SEVERITY="severity",t.TAG="tag",t.OWNER="owner",t.LEAD="lead",t.HOST="host",t.THREAD="thread",t.TEST_METHOD="testMethod",t.TEST_CLASS="testClass",t.PACKAGE="package",t.FRAMEWORK="framework",t.LANGUAGE="language",t.LAYER="layer",t})({}),Ct=(function(t){return t.BLOCKER="blocker",t.CRITICAL="critical",t.NORMAL="normal",t.MINOR="minor",t.TRIVIAL="trivial",t})({}),M=(function(t){return t.TEXT="text/plain",t.XML="application/xml",t.HTML="text/html",t.CSV="text/csv",t.TSV="text/tab-separated-values",t.CSS="text/css",t.URI="text/uri-list",t.SVG="image/svg+xml",t.PNG="image/png",t.JSON="application/json",t.ZIP="application/zip",t.WEBM="video/webm",t.JPEG="image/jpeg",t.MP4="video/mp4",t.IMAGEDIFF="application/vnd.allure.image.diff",t})({}),P=(function(t){return t.DEFAULT="link",t.ISSUE="issue",t.TMS="tms",t})({});function V(){V=function(o,a){return new r(o,void 0,a)};var t=RegExp.prototype,e=new WeakMap;function r(n,o,a){var p=RegExp(n,o);return e.set(p,a||e.get(n)),L(p,r.prototype)}function s(n,o){var a=e.get(o);return Object.keys(a).reduce(function(p,i){var g=a[i];if(typeof g=="number")p[i]=n[g];else{for(var S=0;n[g[S]]===void 0&&S+1<g.length;)S++;p[i]=n[g[S]]}return p},Object.create(null))}return gr(r,RegExp),r.prototype.exec=function(n){var o=t.exec.call(this,n);if(o){o.groups=s(o,this);var a=o.indices;a&&(a.groups=s(a,this))}return o},r.prototype[Symbol.replace]=function(n,o){if(typeof o=="string"){var a=e.get(this);return t[Symbol.replace].call(this,n,o.replace(/\$<([^>]+)(>|$)/g,function(i,g,S){if(S==="")return i;var v=a[g];return Array.isArray(v)?"$"+v.join("$"):typeof v=="number"?"$"+v:""}))}if(typeof o=="function"){var p=this;return t[Symbol.replace].call(this,n,function(){var i=arguments;return typeof i[i.length-1]!="object"&&(i=[].slice.call(i)).push(s(i,p)),o.apply(this,i)})}return t[Symbol.replace].call(this,n,o)},V.apply(this,arguments)}function gr(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&L(t,e)}function L(t,e){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},L(t,e)}function bt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function q(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bt(Object(r),!0).forEach(function(s){yr(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bt(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}function yr(t,e,r){return(e=hr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hr(t){var e=Sr(t,"string");return typeof e=="symbol"?e:e+""}function Sr(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var x=t=>{switch(!0){case/assert/gi.test(t.constructor.name):case/expectation/gi.test(t.constructor.name):case(t.name&&/assert/gi.test(t.name)):case(t.message&&/assert/gi.test(t.message)):case(t.stack&&/@vitest\/expect/gi.test(t.stack)):case(t.stack&&/playwright\/lib\/matchers\/expect\.js/gi.test(t.stack)):case"matcherResult"in t:case("inspect"in t&&typeof t.inspect=="function"):return u.FAILED;default:return u.BROKEN}},vr=function(){var{onlyFirst:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(r,e?void 0:"g")},Y=t=>{var e=vr();return t.replace(e,"")},xr=t=>{if(!t||typeof t!="object")return{};if("matcherResult"in t&&t.matcherResult!==void 0&&typeof t.matcherResult=="object")return{actual:C(t.matcherResult.actual),expected:C(t.matcherResult.expected)};var e="actual"in t&&t.actual!==void 0?{actual:C(t.actual)}:{},r="expected"in t&&t.expected!==void 0?{expected:C(t.expected)}:{};return q(q({},e),r)},h=t=>{var{message:e,stack:r}=t;return q({message:e?Y(e):void 0,trace:r?Y(r):void 0},xr(t))};var Tr=V(/(?:^|\s)@?allure\.([^:=\s]+)[:=]("[^"]+"|'[^']+'|`[^`]+`|\S+)/,{type:1}),Et=new RegExp(Tr,"g");var Cr=t=>t?.[1],br=t=>{var e,r=/['"`]/,s=new RegExp("^".concat(r.source)),n=new RegExp("".concat(r.source,"$")),o=(e=t?.[2])!==null&&e!==void 0?e:"";return s.test(o)&&n.test(o)?o.slice(1,-1):o};var J=t=>{var e=[],r=[],s=t.matchAll(Et),n=t.replaceAll(Et,"").split(" ").filter(Boolean).reduce((v,K)=>/^[\n\r]/.test(K)?v+K:"".concat(v," ").concat(K),"").trim();for(var o of s){var a=o,p=Cr(a),i=br(a);if(!(!p||!i)){var[g,S]=p.split(".");switch(g){case"id":e.push({name:c.ALLURE_ID,value:i});break;case"label":e.push({name:S,value:i});break;case"link":r.push({type:S,url:i});break}}}return{labels:e,links:r,cleanTitle:n}};var D=t=>!!t&&(typeof t=="object"||typeof t=="function")&&typeof t.then=="function",C=function(e){var{maxDepth:r=0,maxLength:s=0,replacer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Rr(typeof e=="object"?JSON.stringify(e,Er(r,n)):String(e),s)},Er=(t,e)=>{var r=[],s=function(o,a){if(typeof a!="object"||a===null)return a;for(;r.length>0&&!Object.is(r.at(-1),this);)r.pop();if(!(t&&r.length>=t||r.includes(a)))return r.push(a),a instanceof Map?Pr(r,a):a instanceof Set?Dr(r,a):a};return e?Ar(e,s):s},Ar=(t,e)=>function(r,s){return e.call(this,r,t.call(this,r,s))},Pr=(t,e)=>Array.from(e).filter(r=>{var[s]=r;return!t.includes(s)}).map(r=>{var[s,n]=r;return[s,t.includes(n)?void 0:n]}),Dr=(t,e)=>Array.from(e).map(r=>t.includes(r)?void 0:r),Rr=(t,e)=>e&&t.length>e?"".concat(t.substring(0,e),"..."):t;function At(t,e,r,s,n,o,a){try{var p=t[o](a),i=p.value}catch(g){return void r(g)}p.done?e(i):Promise.resolve(i).then(s,n)}function d(t){return function(){var e=this,r=arguments;return new Promise(function(s,n){var o=t.apply(e,r);function a(i){At(o,s,n,a,p,"next",i)}function p(i){At(o,s,n,a,p,"throw",i)}a(void 0)})}}var Z=class{attachment(){var e=this;return d(function*(){yield e.warning()})()}attachmentFromPath(){var e=this;return d(function*(){yield e.warning()})()}description(){var e=this;return d(function*(){yield e.warning()})()}descriptionHtml(){var e=this;return d(function*(){yield e.warning()})()}displayName(){var e=this;return d(function*(){yield e.warning()})()}historyId(){var e=this;return d(function*(){yield e.warning()})()}labels(){var e=this;return d(function*(){yield e.warning()})()}links(){var e=this;return d(function*(){yield e.warning()})()}parameter(){var e=this;return d(function*(){yield e.warning()})()}logStep(){var e=this;return d(function*(){yield e.warning()})()}step(e,r){var s=this;return d(function*(){return yield s.warning(),r()})()}stepDisplayName(){var e=this;return d(function*(){yield e.warning()})()}stepParameter(){var e=this;return d(function*(){yield e.warning()})()}testCaseId(){var e=this;return d(function*(){yield e.warning()})()}warning(){return d(function*(){console.log("no test runtime is found. Please check test framework configuration")})()}},b=new Z;function wr(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+)?)\.([cm]?)ts$/i,function(r,s,n,o,a){return s?e?".jsx":".js":!n||o&&a?n+o+"."+a.toLowerCase()+"js":r}):t}var Pt="allureTestRuntime",Q=t=>{globalThis[Pt]=()=>t},X=()=>globalThis?.[Pt],tt=()=>{var t=X();if(t){var e;return(e=t())!==null&&e!==void 0?e:b}return b},et=()=>{var t=X();if(t){var e;return(e=t())!==null&&e!==void 0?e:b}var r="allure-playwright/autoconfig";return import(wr(r)).then(()=>{var s,n;return(s=(n=X())===null||n===void 0?void 0:n())!==null&&s!==void 0?s:b}).catch(()=>b)};var m=function(e){for(var r=arguments.length,s=new Array(r>1?r-1:0),n=1;n<r;n++)s[n-1]=arguments[n];var o=et();return D(o)?o.then(a=>a[e](...s)):o[e](...s)},y=(t,e)=>m("labels",{name:t,value:e}),Dt=function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return m("labels",...r)},I=(t,e,r)=>m("links",{url:t,type:r,name:e}),Rt=function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return m("links",...r)},wt=(t,e,r)=>m("parameter",t,e,r),kt=t=>m("description",t),_t=t=>m("descriptionHtml",t),Mt=t=>m("displayName",t),Lt=t=>m("historyId",t),It=t=>m("testCaseId",t),Ft=(t,e,r)=>{var s=typeof r=="string"?{contentType:r}:r;return m("attachment",t,e,s)},Ot=(t,e)=>m("attachmentFromPath",t,e,{contentType:"application/vnd.allure.playwright-trace"}),jt=(t,e,r)=>{var s=typeof r=="string"?{contentType:r}:r;return m("attachmentFromPath",t,e,s)},kr=()=>({displayName:t=>m("stepDisplayName",t),parameter:(t,e,r)=>m("stepParameter",t,e,r)}),Ht=(t,e,r)=>m("logStep",t,e,r),Nt=(t,e)=>m("step",t,()=>e(kr())),Ut=(t,e)=>I(t,e,P.ISSUE),Gt=(t,e)=>I(t,e,P.TMS),zt=t=>y(c.ALLURE_ID,t),Bt=t=>y(c.EPIC,t),Wt=t=>y(c.FEATURE,t),Kt=t=>y(c.STORY,t),$t=t=>y(c.SUITE,t),Vt=t=>y(c.PARENT_SUITE,t),qt=t=>y(c.SUB_SUITE,t),Yt=t=>y(c.OWNER,t),Jt=t=>y(c.SEVERITY,t),Zt=t=>y(c.LAYER,t),Xt=t=>y(c.TAG,t),Qt=function(){for(var e=arguments.length,r=new Array(e),s=0;s<e;s++)r[s]=arguments[s];return m("labels",...r.map(n=>({name:c.TAG,value:n})))};var te={stepsFromCommands:{maxArgumentLength:128,maxArgumentDepth:3}},ee=(t,e)=>{let r=t.findIndex(e);return r!==-1?rt(t.splice(r)):[]},rt=t=>{let e=t.length,r=new Array(e);for(let s=0;s<e;s++)r[e-s-1]=t[s];return r},re=t=>t[t.length-1],se=t=>typeof t<"u";var f=()=>{let t=Cypress.env("allure");return t||(t={config:te,initialized:!1,messages:[],testPlan:void 0,currentTest:void 0,projectDir:void 0,stepStack:[],stepsToFinalize:[],nextApiStepId:0},Cypress.env("allure",t)),t},ne=()=>f().initialized,oe=()=>{f().initialized=!0},st=()=>f().messages,ae=t=>{f().messages=t},l=t=>{st().push(t)},ie=()=>f().testPlan,pe=()=>f().projectDir,ue=()=>f().currentTest,ce=t=>{f().currentTest=t},le=()=>{f().currentTest=void 0},me=()=>f().config,T=()=>f().stepStack,fe=()=>re(T()),F=t=>T().push(t);var Mr=t=>rt(T().splice(t)),de=()=>Mr(0);var O=(t,e)=>f().stepsToFinalize.push([t,e]),ge=()=>f().stepsToFinalize,ye=()=>{let t=f();t.stepsToFinalize=[]};var he=(t,e)=>{let r=ie();if(r){let s=Se(t);for(let n of Lr(e)){let o=Ir(r,t,s,n.tests);Fr(n.tests,o)}}},Lr=function*(t){let e=[];for(let r=t;r;r=e.pop()){yield r;for(let s=r.suites.length-1;s>=0;s--)e.push(r.suites[s])}},Ir=(t,e,r,s)=>{let n=[];return s.forEach((o,a)=>{let{fullNameSuffix:p,labels:i}=nt(o),g=`${r}#${p}`,S=i.find(({name:v})=>v===c.ALLURE_ID)?.value;Or(t,g,S)||n.push(a)}),n},Fr=(t,e)=>{for(let r=e.length-1;r>=0;r--)t.splice(e[r],1)},Or=(t,e,r)=>t.tests.some(s=>r&&s.id?.toString()===r||s.selector===e);var j="__allure_report_system_hook__",ve=()=>{Cypress.mocha.getRunner().on("start",jr).on("suite",Hr).on("suite end",Ae).on("hook",Nr).on("hook end",Ur).on("test",Gr).on("pass",Pe).on("fail",zr).on("pending",De).on("test end",ut)},xe=()=>{afterEach(j,ct),after(j,Br)},jr=()=>{Ce(),be()},Hr=t=>{t.root&&he(Cypress.spec,t),Ee(t)},Nr=t=>{E(t)||ot(t)},Ur=t=>{E(t)||H(t)},Gr=t=>{R(t)||at(t)},zr=(t,e)=>{let r="hookName"in t;if(r&&Te(t))return;r&&E(t)&&ot(t,Date.now()-(t.duration??0)),it(e),r&&pt(t,e)},Br=function(){ct(),A(this)};var Re=Cypress.platform==="win32",we=t=>t.substring(t.lastIndexOf(Re?"\\":"/")+1),Se=t=>{let e=pe(),r=e?t.absolute.substring(e.length+1):t.relative;return Re?r.replaceAll("\\","/"):r},ke=t=>Array.isArray(t)||t.buffer?btoa(String.fromCharCode.apply(null,t)):t,lt=t=>({...nt(t),start:typeof t.wallClockStartedAt=="string"?Date.parse(t.wallClockStartedAt):t.wallClockStartedAt?.getTime?.()||Date.now()}),_e=t=>({duration:t.duration??0,retries:t._retries??0}),mt=()=>({statusDetails:{message:"This is a pending test"}}),Me=(t,e,r)=>{let s={id:t.id,stop:Date.now(),status:e??Ue(t)};return r&&(s.statusDetails=r),s},Le=Symbol("The test has been reported to Allure"),ft=t=>{t[Le]=!0},R=t=>t[Le]===!0,Wr=function*(t){let e=[];for(let r=t;r;r=e.pop()){yield r;for(let s=r.suites.length-1;s>=0;s--)e.push(r.suites[s])}},Ie=function*(t){for(let e of Wr(t))yield*e.tests},Fe=t=>{let e=[];for(let r=t.parent;r;r=r.parent)e.push(r);return e.reverse(),e};var Oe=()=>(f().nextApiStepId++).toString(),nt=t=>{let e=t.title,{cleanTitle:r,labels:s,links:n}=J(e),a=`${[...t.titlePath().slice(0,-1),r].join(" ")}`;return{name:r,labels:s,links:n,fullNameSuffix:a}},E=t=>t.title.includes(j),Te=t=>t.parent.root&&t.hookName==="after all",je=t=>{let e=t.test;return t.test.parent.hooks.findLast(o=>o.hookName==="after all")?.hookId===e.hookId},He=(t,e,r,s)=>{let n=e?u.SKIPPED:x(r),{message:o,trace:a}=h(r);return{status:n,statusDetails:{message:e?Kr(t,s):o,trace:a}}},Kr=(t,e)=>{let r=e.title?`'${e.title}'`:"root";return`'${t}' defined in the ${r} suite has failed`},w=t=>typeof t.attributes.consoleProps=="function"?t.attributes.consoleProps():t.attributes.consoleProps,Ne=t=>typeof t?.attributes?.renderProps=="function"?t.attributes.renderProps():t.attributes?.renderProps;var k={},Ge=t=>t.type==="api",_=t=>t.type==="log",N=t=>B($r(),t),$r=()=>{let t=Oe();return F({id:t,type:"api"}),t},ze=t=>{let e=x(t),r=h(t);qr(e,r),We(t)},U=(t,e)=>G(r=>Ge(r),t,e),G=(t,e,r)=>Be(ee(T(),t),e,r),z=(t,e)=>Be(de(),t,e),dt=()=>{z(),ge().forEach(Vr),ye()},Ue=t=>t.error?x(t.error):u.PASSED,Vr=([t,e])=>{let{id:r,error:s}=t,n={id:r};s&&(n.statusDetails=h(s)),e?.(n),l({type:"cypress_step_finalize",data:n})},qr=(t,e)=>{let r=T(),s=r.at(r.findLastIndex(_)+1);s&&G(n=>Object.is(n,s),t,e)},Yr=(t,e)=>{if(_(t)){let r=t.log.attributes.error;if(r)return t.error=r}return e&&(t.error=e),t.error},Be=(t,e,r)=>{let s;for(let n of t)s=Yr(n,s),Jr(n,e,r);s&&We(s)},We=t=>T().forEach(e=>e.error=t),Jr=(t,e,r)=>{Ke(t,e,r),Ge(t)&&t.error&&O(t)};var Ce=()=>Q(new gt),yt=()=>tt(),gt=class{constructor(){this.#e()}labels(...e){return this.#t({type:"metadata",data:{labels:e}})}links(...e){return this.#t({type:"metadata",data:{links:e}})}parameter(e,r,s){return this.#t({type:"metadata",data:{parameters:[{name:e,value:r,...s}]}})}description(e){return this.#t({type:"metadata",data:{description:e}})}descriptionHtml(e){return this.#t({type:"metadata",data:{descriptionHtml:e}})}displayName(e){return this.#t({type:"metadata",data:{displayName:e}})}historyId(e){return this.#t({type:"metadata",data:{historyId:e}})}testCaseId(e){return this.#t({type:"metadata",data:{testCaseId:e}})}attachment(e,r,s){let n=r?.type==="Buffer"?r.data:r,o=typeof n=="string"?"utf8":"base64",a=ke(n);return this.#t({type:"attachment_content",data:{name:e,content:a,encoding:o,contentType:s.contentType,fileExtension:s.fileExtension}})}attachmentFromPath(e,r,s){return this.#t({type:"attachment_path",data:{name:e,path:r,contentType:s.contentType,fileExtension:s.fileExtension}})}logStep(e,r=u.PASSED,s){return this.#s()?(N(e),U(r,s?h(s):void 0),Cypress.Promise.resolve()):cy.wrap(k,{log:!1}).then(()=>(N(e),Cypress.Promise.resolve())).then(()=>(U(r,s?h(s):void 0),Cypress.Promise.resolve()))}step(e,r){return cy.wrap(k,{log:!1}).then(()=>(N(e),Cypress.Promise.resolve(r()))).then(s=>(U(),s))}stepDisplayName(e){return this.#t({type:"step_metadata",data:{name:e}})}stepParameter(e,r,s){return this.#t({type:"step_metadata",data:{parameters:[{name:e,value:r,mode:s}]}})}flushAllureMessagesToTask(e){let r=this.#r();r.length&&cy.task(e,{absolutePath:Cypress.spec.absolute,messages:r},{log:!1})}flushAllureMessagesToTaskAsync(e){let r=this.#r();if(r.length){let s={absolutePath:Cypress.spec.absolute,messages:r,isInteractive:Cypress.config("isInteractive")};return cy.task(e,s,{log:!1})}}#e(){ae([])}#t(e){return l(e),Cypress.Promise.resolve()}#r(){let e=st();return this.#e(),e}#s(){try{let e=!!window.cypressOriginContext,r=!!window.cypressOriginWindow;if(e||r)return!0;let s=Cypress.config("baseUrl"),n=window.location.origin;if(s&&n!==s)return!0;let o=window.Cypress;if(o&&o.state&&o.state("origin"))return!0;try{let a=typeof cy<"u",p=typeof cy.task<"u";if(!a||!p)return!0}catch{return!0}return!1}catch{return!0}}};var be=()=>{l({type:"cypress_run_start",data:{}})},Ee=t=>{l({type:"cypress_suite_start",data:{id:t.id,name:t.title,root:t.root,start:Date.now()}})},Ae=t=>{l({type:"cypress_suite_end",data:{root:t.root,stop:Date.now()}})},ot=(t,e)=>{l({type:"cypress_hook_start",data:{name:t.title,scopeType:t.hookName.includes("each")?"each":"all",position:t.hookName.includes("before")?"before":"after",start:e??Date.now()}})},H=t=>{dt(),l({type:"cypress_hook_end",data:{duration:t.duration??0}})},at=t=>{ce(t),l({type:"cypress_test_start",data:lt(t)}),ft(t)},B=(t,e)=>{l({type:"cypress_step_start",data:{id:t,name:e,start:Date.now()}})},Ke=(t,e,r)=>{l({type:"cypress_step_stop",data:Me(t,e,r)})},Pe=()=>{l({type:"cypress_test_pass",data:{}})},it=t=>{let e=x(t),r=h(t);z(e,r),l({type:"cypress_fail",data:{status:e,statusDetails:r}})},pt=(t,e)=>{let r=t.hookName.includes("each"),s=t.parent,n=He(t.title,r,e,s);H(t),Zr(),Xr(s,n)},De=t=>{R(t)?z(u.SKIPPED,{message:"The test was skipped before the command was completed"}):at(t),l({type:"cypress_test_skip",data:mt()})},ut=t=>{dt(),l({type:"cypress_test_end",data:{duration:t.duration??0,retries:t._retries??0}}),le()},$e=(t,e)=>{l({type:"attachment_path",data:{path:t,name:e,contentType:M.PNG}})},A=t=>{if(je(t)){let e=t.test;return E(e)||H(e),Ve()}},ht=(t,e)=>{try{return it(e),pt(t.test,e),Ve()}catch(r){ts(t,r)}},St=(t,e)=>{if(!ht(t,e)?.then(()=>{throw e}))throw e},ct=()=>yt().flushAllureMessagesToTask("reportAllureCypressSpecMessages"),Ve=()=>yt().flushAllureMessagesToTaskAsync("reportFinalAllureCypressSpecMessages"),Zr=()=>{let t=ue();t&&ut(t)},Xr=(t,e)=>{for(let r of Ie(t))R(r)||Qr(r,r.pending?{...mt(),status:u.SKIPPED}:e)},Qr=(t,e)=>{l({type:"cypress_skipped_test",data:{...lt(t),...e,..._e(t),suites:Fe(t).map(r=>r.id)}}),ft(t)},ts=(t,e)=>{try{console.error(`Unexpected error when reporting the failure of ${t.test?.title??"'after all'"}`),console.error(e)}catch{}};var Ye=()=>{let t=es();rs(t),ss(t)},es=()=>{let t=0;return{getSuiteDepth:()=>t,incrementSuiteDepth:()=>{t++},decrementSuiteDepth:()=>{t--}}},rs=({incrementSuiteDepth:t,decrementSuiteDepth:e})=>{let r=o=>(a,p,i)=>{t();try{return ns(o,a,p,i)}finally{e()}},s=globalThis.describe,n=r(s);n.only=r(s.only),n.skip=r(s.skip),globalThis.describe=n},ss=({getSuiteDepth:t})=>{let e=globalThis.after,r=(s,n)=>typeof s=="string"?e(s,qe(t,n)):e(qe(t,s));globalThis.after=r},ns=(t,...e)=>{let[r,s,n]=e;return typeof n>"u"&&typeof s>"u"?t(r):typeof s=="function"?t(r,s):t(r,s,n)},qe=(t,e)=>{if(t()===0&&e){let r=e.length?os(e):as(e);return Object.defineProperty(r,"name",{value:e.name}),r}return e},os=t=>function(e){let r=s=>{if(s){ht(this,s)?.then(()=>e(s))||e(s);return}try{if(A(this)?.then(()=>e()))return}catch(n){e(n);return}e()};return t.bind(this)(r)},as=t=>function(){let e,r;try{e=t.bind(this)()}catch(s){r=s}if(r)St(this,r);else return D(e)?e.then(()=>A(this),s=>St(this,s)):(A(this),e)};var Ze=t=>ps(t)?tr(t):is(t),Xe=t=>typeof t=="object"&&t!==null&&!Array.isArray(t),Qe=(t,e=[])=>{if(!Xe(t))return t;let r={};e.push(t);for(let[s,n]of Object.entries(t))if(typeof n=="object"&&n!==null){if(e.includes(n))continue;r[s]=Qe(n,e)}else r[s]=n;return e.pop(),r},is=t=>{if(Xe(t)){let e=Qe(t);return C({...e},Je())}return C(t,Je())},Je=()=>{let{stepsFromCommands:{maxArgumentDepth:t,maxArgumentLength:e}}=me();return{maxDepth:t,maxLength:e,nonNullReplacerWithDomSupport:us}},ps=t=>typeof t=="object"&&t!==null&&Cypress.dom.isDom(t),tr=t=>Cypress.dom.stringify(t,"long"),us=(t,e)=>{if(typeof e=="object"){if(e===null)return;if(Cypress.dom.isDom(e))return tr(e)}return e};var er=t=>{let{event:e,instrument:r}=t.attributes;return!(r!=="command"||e||ms(t))},rr=(t,e)=>{let r=fe();if(r&&_(r)){let{name:s,props:{name:n}}=w(r.log);s==="screenshot"&&n===t&&(r.attachmentName=e)}},sr=t=>{let e=vs();typeof e<"u"&&xs(e.log,t)&&W(e.log.attributes.id),cs(t),B(t.attributes.id,fs(t)),ls(t)},W=t=>G(({id:e})=>e===t),cs=t=>{let r={id:t.attributes.id,type:"log",log:t};F(r),O(r,s=>{s.parameters=ds(t),r.attachmentName&&(s.name=r.attachmentName)})},ls=t=>{let{groupStart:e,end:r,id:s}=t.attributes;if(r)W(s);else if(e){let n=t.endGroup;t.endGroup=function(){return W(s),n.call(this)}}else{let n=t.end;t.end=function(){return W(s),n.call(this)}}},ms=t=>{let{name:e}=t.attributes;return e==="then"&&Object.is(w(t).props["Applied To"],k)},fs=t=>{let{name:e,message:r,displayName:s}=t.attributes,n=(s??e).trim(),o=(nr(t)??ys(t)??Ne(t).message??r).trim();return[n,o].filter(Boolean).join(" ")},ds=t=>hs(t).map(([e,r])=>({name:e.toString(),value:Ze(r)})).filter(Ts(t)),gs=["Given","When","Then","And"],ys=t=>{let{attributes:{name:e,message:r}}=t;if(gs.includes(e.trim())&&r.startsWith("**")&&r.endsWith("**"))return r.substring(2,r.length-2)},hs=t=>{let e=!!nr(t),{props:r,name:s}=w(t);return["clearLocalStorage"].includes(s)?[]:Object.entries(r).filter(([n,o])=>se(o)&&!(e&&n==="Message"))},nr=t=>{if(Ss(t)){let e=w(t).props.Message;if(e&&typeof e=="string")return e}},Ss=({attributes:{name:t}})=>t==="assert",vs=()=>T().findLast(_),xs=(t,e)=>{let{groupStart:r,type:s}=t.attributes,{type:n}=e.attributes;return!r&&(s==="child"||n!=="child")},Ts=t=>t.attributes.name==="wrap"?()=>!0:({name:e,value:r})=>e!=="Yielded"||r!=="{}";var or=()=>Cypress.on("fail",ar).on("log:added",bs),vt=()=>Cypress.Screenshot.defaults({onAfterScreenshot:Cs}),Cs=(...[,{name:t,path:e}])=>{let r=t??we(e);$e(e,r),rr(t,r)},bs=(t,e)=>{er(e)&&sr(e)},ar=t=>{if(ze(t),Es())throw t},Es=()=>Object.is(Cypress.listeners("fail").at(-1),ar);var ir=()=>{ve(),or(),xe(),Ye()};var pr=()=>{ne()||(oe(),ir(),vt())};pr();
//# sourceMappingURL=index.js.map

{"version":3,"file":"runtime.js","names":["_allureJsCommons","require","_sdk","_runtime","_state","_steps","_utils","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_toPropertyKey","value","configurable","writable","i","_toPrimitive","Symbol","toPrimitive","call","TypeError","String","Number","_classPrivateMethodInitSpec","a","_checkPrivateRedeclaration","add","has","_assertClassBrand","n","initTestRuntime","setGlobalTestRuntime","AllureCypressTestRuntime","exports","getTestRuntime","getGlobalTestRuntime","_AllureCypressTestRuntime_brand","WeakSet","constructor","_resetMessages","labels","_len","Array","_key","_enqueueMessageAsync","type","data","links","_len2","_key2","parameter","name","options","parameters","description","markdown","descriptionHtml","html","displayName","historyId","testCaseId","attachment","content","attachmentRawContent","actualEncoding","attachmentContent","uint8ArrayToBase64","encoding","contentType","fileExtension","attachmentFromPath","path","logStep","status","undefined","Status","PASSED","error","_isInOriginContext","startAllureApiStep","stopCurrentAllureApiStep","getMessageAndTraceFromError","Cypress","Promise","resolve","cy","wrap","ALLURE_STEP_CMD_SUBJECT","log","then","step","body","result","stepDisplayName","stepParameter","mode","flushAllureMessagesToTask","taskName","messages","_dequeueAllMessages","task","absolutePath","spec","absolute","flushAllureMessagesToTaskAsync","args","isInteractive","config","setRuntimeMessages","message","enqueueRuntimeMessage","getRuntimeMessages","hasOriginContext","window","cypressOriginContext","hasOriginWindow","cypressOriginWindow","baseUrl","currentOrigin","location","origin","cypressInstance","state","cyExists","cyTaskExists"],"sources":["../../../src/browser/runtime.ts"],"sourcesContent":["import type { AttachmentOptions, Label, Link, ParameterMode, ParameterOptions } from \"allure-js-commons\";\nimport { Status } from \"allure-js-commons\";\nimport { getMessageAndTraceFromError } from \"allure-js-commons/sdk\";\nimport type { TestRuntime } from \"allure-js-commons/sdk/runtime\";\nimport { getGlobalTestRuntime, setGlobalTestRuntime } from \"allure-js-commons/sdk/runtime\";\nimport type { AllureCypressTaskArgs, CypressMessage } from \"../types.js\";\nimport { enqueueRuntimeMessage, getRuntimeMessages, setRuntimeMessages } from \"./state.js\";\nimport { ALLURE_STEP_CMD_SUBJECT, startAllureApiStep, stopCurrentAllureApiStep } from \"./steps.js\";\nimport { uint8ArrayToBase64 } from \"./utils.js\";\n\nexport const initTestRuntime = () => setGlobalTestRuntime(new AllureCypressTestRuntime() as TestRuntime);\n\nexport const getTestRuntime = () => getGlobalTestRuntime() as AllureCypressTestRuntime;\n\nclass AllureCypressTestRuntime implements TestRuntime {\n  constructor() {\n    this.#resetMessages();\n  }\n\n  labels(...labels: Label[]) {\n    return this.#enqueueMessageAsync({\n      type: \"metadata\",\n      data: {\n        labels,\n      },\n    });\n  }\n\n  links(...links: Link[]) {\n    return this.#enqueueMessageAsync({\n      type: \"metadata\",\n      data: {\n        links,\n      },\n    });\n  }\n\n  parameter(name: string, value: string, options?: ParameterOptions) {\n    return this.#enqueueMessageAsync({\n      type: \"metadata\",\n      data: {\n        parameters: [\n          {\n            name,\n            value,\n            ...options,\n          },\n        ],\n      },\n    });\n  }\n\n  description(markdown: string) {\n    return this.#enqueueMessageAsync({\n      type: \"metadata\",\n      data: {\n        description: markdown,\n      },\n    });\n  }\n\n  descriptionHtml(html: string) {\n    return this.#enqueueMessageAsync({\n      type: \"metadata\",\n      data: {\n        descriptionHtml: html,\n      },\n    });\n  }\n\n  displayName(name: string) {\n    return this.#enqueueMessageAsync({\n      type: \"metadata\",\n      data: {\n        displayName: name,\n      },\n    });\n  }\n\n  historyId(value: string) {\n    return this.#enqueueMessageAsync({\n      type: \"metadata\",\n      data: {\n        historyId: value,\n      },\n    });\n  }\n\n  testCaseId(value: string) {\n    return this.#enqueueMessageAsync({\n      type: \"metadata\",\n      data: {\n        testCaseId: value,\n      },\n    });\n  }\n\n  // @ts-ignore\n  attachment(name: string, content: string, options: AttachmentOptions) {\n    // @ts-ignore\n    const attachmentRawContent: string | Uint8Array = content?.type === \"Buffer\" ? content.data : content;\n    const actualEncoding = typeof attachmentRawContent === \"string\" ? \"utf8\" : \"base64\";\n    const attachmentContent = uint8ArrayToBase64(attachmentRawContent);\n\n    return this.#enqueueMessageAsync({\n      type: \"attachment_content\",\n      data: {\n        name,\n        content: attachmentContent,\n        encoding: actualEncoding,\n        contentType: options.contentType,\n        fileExtension: options.fileExtension,\n      },\n    });\n  }\n\n  attachmentFromPath(name: string, path: string, options: Omit<AttachmentOptions, \"encoding\">) {\n    return this.#enqueueMessageAsync({\n      type: \"attachment_path\",\n      data: {\n        name,\n        path,\n        contentType: options.contentType,\n        fileExtension: options.fileExtension,\n      },\n    });\n  }\n\n  logStep(name: string, status: Status = Status.PASSED, error?: Error): PromiseLike<void> {\n    if (this.#isInOriginContext()) {\n      startAllureApiStep(name);\n      stopCurrentAllureApiStep(status, error ? getMessageAndTraceFromError(error) : undefined);\n      return Cypress.Promise.resolve();\n    }\n\n    return cy\n      .wrap(ALLURE_STEP_CMD_SUBJECT, { log: false })\n      .then(() => {\n        startAllureApiStep(name);\n        return Cypress.Promise.resolve();\n      })\n      .then(() => {\n        stopCurrentAllureApiStep(status, error ? getMessageAndTraceFromError(error) : undefined);\n        return Cypress.Promise.resolve();\n      });\n  }\n\n  step<T = void>(name: string, body: () => T | PromiseLike<T>) {\n    return cy\n      .wrap(ALLURE_STEP_CMD_SUBJECT, { log: false })\n      .then(() => {\n        startAllureApiStep(name);\n        return Cypress.Promise.resolve(body());\n      })\n      .then((result) => {\n        stopCurrentAllureApiStep();\n        return result;\n      });\n  }\n\n  stepDisplayName(name: string) {\n    return this.#enqueueMessageAsync({\n      type: \"step_metadata\",\n      data: {\n        name,\n      },\n    });\n  }\n\n  stepParameter(name: string, value: string, mode?: ParameterMode) {\n    return this.#enqueueMessageAsync({\n      type: \"step_metadata\",\n      data: {\n        parameters: [{ name, value, mode }],\n      },\n    });\n  }\n\n  flushAllureMessagesToTask(taskName: string) {\n    const messages = this.#dequeueAllMessages();\n    if (messages.length) {\n      cy.task(taskName, { absolutePath: Cypress.spec.absolute, messages }, { log: false });\n    }\n  }\n\n  flushAllureMessagesToTaskAsync(taskName: string): Cypress.Chainable<unknown> | undefined {\n    const messages = this.#dequeueAllMessages();\n    if (messages.length) {\n      const args: AllureCypressTaskArgs = {\n        absolutePath: Cypress.spec.absolute,\n        messages,\n        isInteractive: Cypress.config(\"isInteractive\"),\n      };\n      return cy.task(taskName, args, { log: false });\n    }\n  }\n\n  #resetMessages() {\n    setRuntimeMessages([]);\n  }\n\n  #enqueueMessageAsync(message: CypressMessage): PromiseLike<void> {\n    enqueueRuntimeMessage(message);\n    return Cypress.Promise.resolve();\n  }\n\n  #dequeueAllMessages() {\n    const messages = getRuntimeMessages();\n    this.#resetMessages();\n    return messages;\n  }\n\n  #isInOriginContext(): boolean {\n    try {\n      const hasOriginContext = !!(window as any).cypressOriginContext;\n      const hasOriginWindow = !!(window as any).cypressOriginWindow;\n\n      if (hasOriginContext || hasOriginWindow) {\n        return true;\n      }\n\n      const baseUrl = Cypress.config(\"baseUrl\");\n      const currentOrigin = window.location.origin;\n\n      if (baseUrl && currentOrigin !== baseUrl) {\n        return true;\n      }\n\n      const cypressInstance = (window as any).Cypress;\n\n      if (cypressInstance && cypressInstance.state && cypressInstance.state(\"origin\")) {\n        return true;\n      }\n\n      try {\n        const cyExists = typeof cy !== \"undefined\";\n        const cyTaskExists = typeof cy.task !== \"undefined\";\n\n        // In cy.origin context, cy.task may not be available or may throw\n        if (!cyExists || !cyTaskExists) {\n          return true;\n        }\n      } catch (error) {\n        return true;\n      }\n\n      return false;\n    } catch (error) {\n      return true;\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]}
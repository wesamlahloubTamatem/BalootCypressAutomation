import { type AllureHistory, type AttachmentLink, type DefaultLabelsConfig, type EnvironmentsConfig, type HistoryDataPoint, type HistoryTestResult, type KnownTestFailure, type ReportVariables, type Statistic, type TestCase, type TestEnvGroup, type TestError, type TestFixtureResult, type TestResult } from "@allurereport/core-api";
import { type AllureStore, type AllureStoreDump, type ExitCode, type QualityGateValidationResult, type RealtimeEventsDispatcher, type RealtimeSubscriber, type ResultFile, type TestResultFilter } from "@allurereport/plugin-api";
import type { RawFixtureResult, RawMetadata, RawTestResult, ReaderContext, ResultsVisitor } from "@allurereport/reader-api";
export declare const mapToObject: <K extends string | number | symbol, T = any>(map: Map<K, T>) => Record<K, T>;
export declare const updateMapWithRecord: <K extends string | number | symbol, T = any>(map: Map<K, T>, record: Record<K, T>) => Map<K, T>;
export declare class DefaultAllureStore implements AllureStore, ResultsVisitor {
    #private;
    readonly indexTestResultByTestCase: Map<string, TestResult[]>;
    readonly indexLatestEnvTestResultByHistoryId: Map<string, Map<string, TestResult>>;
    readonly indexTestResultByHistoryId: Map<string, TestResult[]>;
    readonly indexAttachmentByTestResult: Map<string, AttachmentLink[]>;
    readonly indexAttachmentByFixture: Map<string, AttachmentLink[]>;
    readonly indexFixturesByTestResult: Map<string, TestFixtureResult[]>;
    readonly indexKnownByHistoryId: Map<string, KnownTestFailure[]>;
    constructor(params?: {
        history?: AllureHistory;
        known?: KnownTestFailure[];
        realtimeDispatcher?: RealtimeEventsDispatcher;
        realtimeSubscriber?: RealtimeSubscriber;
        defaultLabels?: DefaultLabelsConfig;
        environment?: string;
        environmentsConfig?: EnvironmentsConfig;
        reportVariables?: ReportVariables;
    });
    readHistory(): Promise<HistoryDataPoint[]>;
    appendHistory(history: HistoryDataPoint): Promise<void>;
    qualityGateResults(): Promise<QualityGateValidationResult[]>;
    globalExitCode(): Promise<ExitCode | undefined>;
    allGlobalErrors(): Promise<TestError[]>;
    allGlobalAttachments(): Promise<AttachmentLink[]>;
    visitTestResult(raw: RawTestResult, context: ReaderContext): Promise<void>;
    visitTestFixtureResult(result: RawFixtureResult, context: ReaderContext): Promise<void>;
    visitAttachmentFile(resultFile: ResultFile, context: ReaderContext): Promise<void>;
    visitMetadata(metadata: RawMetadata): Promise<void>;
    allTestCases(): Promise<TestCase[]>;
    allTestResults(options?: {
        includeHidden?: boolean;
    }): Promise<TestResult[]>;
    allAttachments(options?: {
        includeMissed?: boolean;
        includeUnused?: boolean;
    }): Promise<AttachmentLink[]>;
    allMetadata(): Promise<Record<string, any>>;
    allFixtures(): Promise<TestFixtureResult[]>;
    allHistoryDataPoints(): Promise<HistoryDataPoint[]>;
    allHistoryDataPointsByEnvironment(environment: string): Promise<HistoryDataPoint[]>;
    allKnownIssues(): Promise<KnownTestFailure[]>;
    allNewTestResults(): Promise<TestResult[]>;
    testCaseById(tcId: string): Promise<TestCase | undefined>;
    testResultById(trId: string): Promise<TestResult | undefined>;
    attachmentById(attachmentId: string): Promise<AttachmentLink | undefined>;
    attachmentContentById(attachmentId: string): Promise<ResultFile | undefined>;
    metadataByKey<T>(key: string): Promise<T | undefined>;
    testResultsByTcId(tcId: string): Promise<TestResult[]>;
    attachmentsByTrId(trId: string): Promise<AttachmentLink[]>;
    retriesByTr(tr: TestResult): Promise<TestResult[]>;
    retriesByTrId(trId: string): Promise<TestResult[]>;
    historyByTr(tr: TestResult): Promise<HistoryTestResult[] | undefined>;
    historyByTrId(trId: string): Promise<HistoryTestResult[] | undefined>;
    fixturesByTrId(trId: string): Promise<TestFixtureResult[]>;
    failedTestResults(): Promise<TestResult[]>;
    unknownFailedTestResults(): Promise<TestResult[]>;
    testResultsByLabel(labelName: string): Promise<{
        [x: string]: TestResult[];
        _: TestResult[];
    }>;
    testsStatistic(filter?: TestResultFilter): Promise<Statistic>;
    allEnvironments(): Promise<string[]>;
    testResultsByEnvironment(env: string, options?: {
        includeHidden: boolean;
    }): Promise<TestResult[]>;
    allTestEnvGroups(): Promise<TestEnvGroup[]>;
    allVariables(): Promise<ReportVariables>;
    envVariables(env: string): Promise<{
        [x: string]: string;
    }>;
    dumpState(): AllureStoreDump;
    restoreState(stateDump: AllureStoreDump, attachmentsContents?: Record<string, ResultFile>): Promise<void>;
}
